(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[409],{7699:(e,a,s)=>{Promise.resolve().then(s.bind(s,7511))},7511:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>i});var t=s(5155),n=s(2115);function i(){let[e,a]=(0,n.useState)([]),[s,i]=(0,n.useState)(!0),[r,l]=(0,n.useState)(!1),[c,d]=(0,n.useState)(null),[o,h]=(0,n.useState)({prefix:"",name:""}),x=localStorage.getItem("token"),m=async()=>{let e=await fetch("/api/master/networks",{headers:{Authorization:"Bearer ".concat(x)}}),s=await e.json();s.ok&&a(s.data),i(!1)};(0,n.useEffect)(()=>{m()},[]);let p=async e=>{e.preventDefault();let a=c?"/api/master/networks/".concat(c):"/api/master/networks",s=c?"PUT":"POST";await fetch(a,{method:s,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(x)},body:JSON.stringify(o)}),l(!1),d(null),h({prefix:"",name:""}),m()},u=e=>{h({prefix:e.prefix,name:e.name}),d(e.id),l(!0)},j=async e=>{confirm("ยืนยันการลบเครือข่าย?")&&(await fetch("/api/master/networks/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(x)}}),m())},b=async e=>{await fetch("/api/master/networks/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(x)},body:JSON.stringify({isActive:!e.isActive})}),m()};return s?(0,t.jsx)("div",{className:"loading",children:(0,t.jsx)("div",{className:"spinner"})}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"page-header",children:[(0,t.jsx)("h1",{className:"page-title",children:"จัดการเครือข่าย"}),(0,t.jsx)("button",{className:"btn btn-primary",onClick:()=>{h({prefix:"",name:""}),d(null),l(!0)},children:"+ เพิ่มเครือข่าย"})]}),(0,t.jsx)("div",{className:"card",children:0===e.length?(0,t.jsx)("div",{className:"empty-state",children:"ยังไม่มีเครือข่าย"}):(0,t.jsxs)("table",{className:"table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"ชื่อ"}),(0,t.jsx)("th",{children:"Prefix"}),(0,t.jsx)("th",{children:"ผู้ใช้"}),(0,t.jsx)("th",{children:"บัญชี"}),(0,t.jsx)("th",{children:"สถานะ"}),(0,t.jsx)("th",{children:"จัดการ"})]})}),(0,t.jsx)("tbody",{children:e.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:e.name}),(0,t.jsx)("td",{children:(0,t.jsx)("code",{children:e.prefix})}),(0,t.jsx)("td",{children:e._count.users}),(0,t.jsx)("td",{children:e._count.accounts}),(0,t.jsx)("td",{children:(0,t.jsx)("span",{className:"badge ".concat(e.isActive?"badge-success":"badge-error"),children:e.isActive?"ใช้งาน":"ปิด"})}),(0,t.jsxs)("td",{style:{display:"flex",gap:8},children:[(0,t.jsx)("button",{className:"btn btn-secondary",style:{padding:"8px 12px"},onClick:()=>b(e),children:e.isActive?"ปิด":"เปิด"}),(0,t.jsx)("button",{className:"btn btn-secondary",style:{padding:"8px 12px"},onClick:()=>u(e),children:"แก้ไข"}),(0,t.jsx)("button",{className:"btn btn-danger",style:{padding:"8px 12px"},onClick:()=>j(e.id),children:"ลบ"})]})]},e.id))})]})}),r&&(0,t.jsx)("div",{className:"modal-overlay",onClick:()=>l(!1),children:(0,t.jsxs)("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("h2",{className:"modal-title",children:c?"แก้ไขเครือข่าย":"เพิ่มเครือข่าย"}),(0,t.jsxs)("form",{onSubmit:p,children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Prefix (ใช้ใน URL)"}),(0,t.jsx)("input",{type:"text",className:"form-input",value:o.prefix,onChange:e=>h({...o,prefix:e.target.value}),placeholder:"shop1",pattern:"^[a-z0-9_-]+$",required:!0,disabled:!!c})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"ชื่อเครือข่าย"}),(0,t.jsx)("input",{type:"text",className:"form-input",value:o.name,onChange:e=>h({...o,name:e.target.value}),placeholder:"ร้านค้า ABC",required:!0})]}),(0,t.jsxs)("div",{className:"modal-actions",children:[(0,t.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>l(!1),children:"ยกเลิก"}),(0,t.jsx)("button",{type:"submit",className:"btn btn-primary",children:c?"บันทึก":"เพิ่ม"})]})]})]})})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[441,517,358],()=>a(7699)),_N_E=e.O()}]);