(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[33],{4654:(e,a,t)=>{Promise.resolve().then(t.bind(t,3783))},3783:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>r});var n=t(5155),s=t(2115),l=t(6046);function r(){let e=(0,l.useParams)().prefix,[a,t]=(0,s.useState)([]),[r,c]=(0,s.useState)(!0),[i,o]=(0,s.useState)(!1),[d,u]=(0,s.useState)(null),[h,m]=(0,s.useState)({name:"",phoneNumber:"",walletEndpointUrl:"",walletBearerToken:""}),p=localStorage.getItem("token"),x=async()=>{let a=await fetch("/api/tenant/".concat(e,"/accounts"),{headers:{Authorization:"Bearer ".concat(p)}}),n=await a.json();n.ok&&t(n.data),c(!1)};(0,s.useEffect)(()=>{x()},[e]);let j=async a=>{a.preventDefault();let t=d?"/api/tenant/".concat(e,"/accounts/").concat(d):"/api/tenant/".concat(e,"/accounts"),n=d?"PUT":"POST";await fetch(t,{method:n,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(p)},body:JSON.stringify(h)}),o(!1),u(null),m({name:"",phoneNumber:"",walletEndpointUrl:"",walletBearerToken:""}),x()},b=async a=>{confirm("ยืนยันการลบบัญชี?")&&(await fetch("/api/tenant/".concat(e,"/accounts/").concat(a),{method:"DELETE",headers:{Authorization:"Bearer ".concat(p)}}),x())},N=async a=>{await fetch("/api/tenant/".concat(e,"/accounts/").concat(a.id),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(p)},body:JSON.stringify({isActive:!a.isActive})}),x()};return r?(0,n.jsx)("div",{className:"loading",children:(0,n.jsx)("div",{className:"spinner"})}):(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"page-header",children:[(0,n.jsx)("h1",{className:"page-title",children:"จัดการบัญชี"}),(0,n.jsx)("button",{className:"btn btn-primary",onClick:()=>{m({name:"",phoneNumber:"",walletEndpointUrl:"",walletBearerToken:""}),u(null),o(!0)},children:"+ ผูกบัญชีใหม่"})]}),(0,n.jsx)("div",{className:"card",children:0===a.length?(0,n.jsx)("div",{className:"empty-state",children:"ยังไม่มีบัญชี TrueWallet"}):(0,n.jsxs)("table",{className:"table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"ชื่อ"}),(0,n.jsx)("th",{children:"เบอร์โทร"}),(0,n.jsx)("th",{children:"สถานะ"}),(0,n.jsx)("th",{children:"จัดการ"})]})}),(0,n.jsx)("tbody",{children:a.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.name}),(0,n.jsx)("td",{children:e.phoneNumber||"-"}),(0,n.jsx)("td",{children:(0,n.jsx)("span",{className:"badge ".concat(e.isActive?"badge-success":"badge-error"),children:e.isActive?"ใช้งาน":"ปิด"})}),(0,n.jsxs)("td",{style:{display:"flex",gap:8},children:[(0,n.jsx)("button",{className:"btn btn-secondary",style:{padding:"8px 12px"},onClick:()=>N(e),children:e.isActive?"ปิด":"เปิด"}),(0,n.jsx)("button",{className:"btn btn-danger",style:{padding:"8px 12px"},onClick:()=>b(e.id),children:"ลบ"})]})]},e.id))})]})}),i&&(0,n.jsx)("div",{className:"modal-overlay",onClick:()=>o(!1),children:(0,n.jsxs)("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("h2",{className:"modal-title",children:"ผูกบัญชี TrueWallet"}),(0,n.jsxs)("form",{onSubmit:j,children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label",children:"ชื่อบัญชี"}),(0,n.jsx)("input",{type:"text",className:"form-input",value:h.name,onChange:e=>m({...h,name:e.target.value}),required:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label",children:"เบอร์โทร"}),(0,n.jsx)("input",{type:"text",className:"form-input",value:h.phoneNumber,onChange:e=>m({...h,phoneNumber:e.target.value})})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label",children:"Wallet Endpoint URL"}),(0,n.jsx)("input",{type:"url",className:"form-input",value:h.walletEndpointUrl,onChange:e=>m({...h,walletEndpointUrl:e.target.value}),required:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label",children:"Bearer Token"}),(0,n.jsx)("input",{type:"text",className:"form-input",value:h.walletBearerToken,onChange:e=>m({...h,walletBearerToken:e.target.value}),required:!0})]}),(0,n.jsxs)("div",{className:"modal-actions",children:[(0,n.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>o(!1),children:"ยกเลิก"}),(0,n.jsx)("button",{type:"submit",className:"btn btn-primary",children:"ผูกบัญชี"})]})]})]})})]})}},6046:(e,a,t)=>{"use strict";var n=t(6658);t.o(n,"useParams")&&t.d(a,{useParams:function(){return n.useParams}}),t.o(n,"usePathname")&&t.d(a,{usePathname:function(){return n.usePathname}}),t.o(n,"useRouter")&&t.d(a,{useRouter:function(){return n.useRouter}})}},e=>{var a=a=>e(e.s=a);e.O(0,[441,517,358],()=>a(4654)),_N_E=e.O()}]);