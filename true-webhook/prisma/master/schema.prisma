generator client {
  provider = "prisma-client-js"
  output   = "../../src/generated/prisma-master"
}

datasource db {
  provider = "postgresql"
}

enum UserRole {
  MASTER
  TENANT_ADMIN
  TENANT_USER
}

model Tenant {
  id             String   @id @default(cuid())
  name           String
  prefix         String   @unique
  schemaName     String   @unique  // e.g., "tenant_abc"
  isActive       Boolean  @default(true)
  maxAccounts    Int      @default(10)
  
  // Branding (optional)
  logoUrl        String?
  primaryColor   String?  @default("#6366f1")
  
  users          User[]

  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
}

model User {
  id             String    @id @default(cuid())
  email          String    @unique
  passwordHash   String
  role           UserRole  @default(TENANT_USER)
  displayName    String?
  
  tenantId       String?
  tenant         Tenant?   @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  
  // Session
  lastLoginAt    DateTime?
  refreshToken   String?

  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt

  @@index([tenantId])
  @@index([email])
}
